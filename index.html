<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winions Meme Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { margin: 0; padding: 0; background: #000; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
const { useState } = React;

function WinionsMemeGenerator() {
  const [selectedTemplate, setSelectedTemplate] = useState('distracted');
  const [texts, setTexts] = useState({ text1: 'MY GIRLFRIEND', text2: 'ME', text3: 'OTHER WINIONS' });
  const [isGenerating, setIsGenerating] = useState(false);
  const [generatedMeme, setGeneratedMeme] = useState(null);

  const templates = {
    distracted: {
      name: 'Distracted Boyfriend',
      fields: ['text1', 'text2', 'text3'],
      labels: ['Girlfriend', 'Boyfriend', 'Other Person'],
      prompt: 'Distracted boyfriend meme: Three Winion figures on urban sidewalk. Left: angry Winion girlfriend in red glow. Center: Winion boyfriend in blue glow looking back. Right: attractive Winion in green glow. All are glitchy VHS aesthetic digital humanoids with flowing robes, no feet, CRT scanlines, chromatic aberration'
    },
    drake: {
      name: 'Drake Format',
      fields: ['text1', 'text2'],
      labels: ['Reject', 'Approve'],
      prompt: 'Drake meme: Two panels. Top: Winion with hand raised rejecting, red VHS glitch. Bottom: Same Winion pointing with approval, green glow. Glitchy digital humanoid with flowing robe, CRT scanlines'
    },
    buttons: {
      name: 'Two Buttons',
      fields: ['text1', 'text2'],
      labels: ['Button 1', 'Button 2'],
      prompt: 'Two buttons meme: Two red buttons at top. Below: stressed Winion looking up, sweating. Winion is glitchy VHS creature with flowing robe, CRT scanlines, blue glow'
    }
  };

  const generateMeme = async () => {
    setIsGenerating(true);
    try {
      const response = await fetch('/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          prompt: templates[selectedTemplate].prompt,
          style: 'meme'
        })
      });

      if (!response.ok) throw new Error('Failed to generate');
      
      const data = await response.json();
      const url = data.data[0]?.url;
      
      if (!url) throw new Error('No URL returned');
      
      setGeneratedMeme(url);
    } catch (error) {
      alert(error.message);
    } finally {
      setIsGenerating(false);
    }
  };

  const downloadMeme = async () => {
    if (!generatedMeme) return;
    
    try {
      const proxiedUrl = `/api/proxy-image?url=${encodeURIComponent(generatedMeme)}`;
      const response = await fetch(proxiedUrl);
      const blob = await response.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `winions-${selectedTemplate}.png`;
      a.click();
      URL.revokeObjectURL(url);
    } catch (error) {
      alert('Download failed');
    }
  };

  return (
    <div className="min-h-screen bg-black text-white p-6">
      <div className="max-w-6xl mx-auto">
        <h1 className="text-5xl font-black mb-2 text-red-500 text-center">WINIONS MEME GENERATOR</h1>
        <p className="text-gray-400 text-center mb-8">AI generates memes with Winions</p>

        <div className="grid lg:grid-cols-2 gap-6">
          <div className="border border-gray-800 rounded-lg p-6">
            <h2 className="text-xl font-bold mb-4 text-red-500">PREVIEW</h2>
            
            <div className="bg-gray-900 rounded-lg border border-gray-800 min-h-[500px] flex items-center justify-center">
              {generatedMeme ? (
                <img src={generatedMeme} alt="Meme" className="w-full h-auto" />
              ) : (
                <div className="text-center p-8">
                  <p className="text-gray-400">Generate a meme</p>
                </div>
              )}
            </div>

            <button
              onClick={downloadMeme}
              disabled={!generatedMeme}
              className="w-full mt-4 bg-red-600 hover:bg-red-700 disabled:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg"
            >
              DOWNLOAD
            </button>
          </div>

          <div className="space-y-4">
            <div className="border border-gray-800 rounded-lg p-6 bg-gray-900">
              <h3 className="text-xl font-bold mb-4 text-red-500">FORMAT</h3>
              
              <div className="grid grid-cols-2 gap-2 mb-4">
                {Object.entries(templates).map(([key, template]) => (
                  <button
                    key={key}
                    onClick={() => setSelectedTemplate(key)}
                    className={`p-3 rounded-lg font-semibold ${
                      selectedTemplate === key ? 'bg-red-600 text-white' : 'bg-black border border-gray-800 text-gray-400'
                    }`}
                  >
                    {template.name}
                  </button>
                ))}
              </div>

              <button
                onClick={generateMeme}
                disabled={isGenerating}
                className="w-full bg-red-600 hover:bg-red-700 disabled:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg"
              >
                {isGenerating ? 'Generating...' : 'GENERATE MEME'}
              </button>
            </div>

            <div className="border border-gray-800 rounded-lg p-6 bg-gray-900">
              <h3 className="text-xl font-bold mb-4 text-red-500">TEXT</h3>
              
              <div className="space-y-3">
                {templates[selectedTemplate].fields.map((field, idx) => (
                  <div key={field}>
                    <label className="block text-sm font-semibold text-gray-400 mb-2">
                      {templates[selectedTemplate].labels[idx]}
                    </label>
                    <input
                      type="text"
                      value={texts[field]}
                      onChange={(e) => setTexts({...texts, [field]: e.target.value})}
                      className="w-full bg-black border border-gray-800 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500"
                    />
                  </div>
                ))}
              </div>
            </div>

            <div className="border border-red-900 rounded-lg p-6 bg-gradient-to-br from-red-950/20 to-black text-center">
              <a href="https://winions.xyz" target="_blank" className="inline-block bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg">
                WINIONS.XYZ
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<WinionsMemeGenerator />);
    </script>
</body>
</html>
